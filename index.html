<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kavency Super Market - Online Grocery Delivery</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2e7d32;
            --primary-dark: #1b5e20;
            --secondary: #ff9800;
            --light: #f8f9fa;
            --dark: #343a40;
            --danger: #dc3545;
            --success: #28a745;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
        }
        
        /* Header Styles */
        .announcement-bar {
            background-color: var(--primary-dark);
            color: white;
            padding: 10px 0;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .main-header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }
        
        /* Logo */
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }
        
        .logo-icon {
            background-color: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .logo-text h1 {
            color: var(--primary);
            font-size: 24px;
            font-weight: 700;
            line-height: 1.2;
        }
        
        .logo-text span {
            color: var(--secondary);
        }
        
        .logo-text p {
            font-size: 12px;
            color: #666;
        }
        
        /* Search Bar */
        .search-container {
            flex: 1;
            max-width: 600px;
            position: relative;
        }
        
        .search-bar {
            display: flex;
            gap: 10px;
        }
        
        .search-input {
            flex: 1;
            padding: 14px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 30px;
            font-size: 16px;
            transition: var(--transition);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        .search-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 30px;
            padding: 0 25px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }
        
        .search-btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        /* Header Actions */
        .header-actions {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            text-decoration: none;
            color: var(--dark);
            transition: var(--transition);
            padding: 8px 12px;
            border-radius: var(--border-radius);
        }
        
        .action-btn:hover {
            background-color: rgba(46, 125, 50, 0.08);
            color: var(--primary);
        }
        
        .action-icon {
            font-size: 22px;
            position: relative;
        }
        
        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 600;
        }
        
        .action-text {
            font-size: 12px;
            font-weight: 500;
        }
        
        /* Navigation */
        .main-nav {
            background-color: var(--primary);
        }
        
        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
            overflow-x: auto;
            scrollbar-width: none;
        }
        
        .nav-links::-webkit-scrollbar {
            display: none;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 500;
            white-space: nowrap;
            transition: var(--transition);
            border-bottom: 3px solid transparent;
        }
        
        .nav-link:hover, .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            border-bottom-color: var(--secondary);
        }
        
        .nav-link i {
            font-size: 14px;
        }
        
        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            padding: 10px;
        }
        
        /* Hero Section */
        .hero-section {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 80px 20px;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .hero-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .hero-title {
            font-size: 48px;
            font-weight: 800;
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .hero-subtitle {
            font-size: 20px;
            margin-bottom: 30px;
            opacity: 0.9;
        }
        
        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        /* Buttons */
        .btn {
            padding: 16px 32px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-size: 16px;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background-color: var(--secondary);
            color: white;
        }
        
        .btn-secondary {
            background-color: white;
            color: var(--primary);
        }
        
        .btn-outline {
            background-color: transparent;
            color: white;
            border: 2px solid white;
        }
        
        .btn-sm {
            padding: 10px 20px;
            font-size: 14px;
        }
        
        /* Section Styles */
        .section {
            max-width: 1200px;
            margin: 0 auto 50px;
            padding: 0 20px;
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .section-title {
            font-size: 28px;
            color: var(--dark);
            font-weight: 700;
            position: relative;
            padding-bottom: 10px;
        }
        
        .section-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background-color: var(--primary);
        }
        
        /* Categories */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .category-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        .category-image {
            height: 120px;
            background-size: cover;
            background-position: center;
            background-color: #f8f9fa;
        }
        
        .category-content {
            padding: 20px;
            text-align: center;
        }
        
        .category-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark);
        }
        
        .category-count {
            font-size: 14px;
            color: #666;
        }
        
        /* Products */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .product-card {
            background: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            position: relative;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.1);
        }
        
        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background-color: var(--danger);
            color: white;
            padding: 5px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            z-index: 1;
        }
        
        .product-image {
            height: 200px;
            background-color: #f8f9fa;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .product-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: var(--transition);
        }
        
        .product-card:hover .product-overlay {
            opacity: 1;
        }
        
        .quick-view-btn {
            background-color: white;
            color: var(--primary);
            border: none;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quick-view-btn:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .product-content {
            padding: 20px;
        }
        
        .product-category {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .product-name {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
            font-size: 16px;
            line-height: 1.4;
            height: 44px;
            overflow: hidden;
        }
        
        .product-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
            height: 42px;
            overflow: hidden;
        }
        
        .product-price {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .price-current {
            font-weight: 700;
            color: var(--primary);
            font-size: 20px;
        }
        
        .price-old {
            text-decoration: line-through;
            color: #999;
            font-size: 14px;
            margin-left: 5px;
        }
        
        .add-to-cart-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .add-to-cart-btn:hover {
            background-color: var(--primary-dark);
            transform: scale(1.1);
        }
        
        /* Featured Section */
        .featured-section {
            background-color: white;
            padding: 50px 20px;
            margin-bottom: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .featured-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            align-items: center;
        }
        
        .featured-content h2 {
            font-size: 36px;
            color: var(--dark);
            margin-bottom: 20px;
            line-height: 1.2;
        }
        
        .featured-content p {
            font-size: 18px;
            color: #666;
            margin-bottom: 30px;
        }
        
        .featured-image {
            height: 300px;
            background-size: cover;
            background-position: center;
            border-radius: var(--border-radius);
        }
        
        /* Payment Methods */
        .payment-section {
            background-color: white;
            padding: 40px 20px;
            border-radius: var(--border-radius);
            margin-bottom: 40px;
        }
        
        .payment-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .payment-method {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }
        
        .payment-method:hover {
            background-color: rgba(46, 125, 50, 0.08);
            transform: translateY(-5px);
        }
        
        .payment-icon {
            font-size: 40px;
            color: var(--primary);
        }
        
        .payment-name {
            font-weight: 500;
            color: var(--dark);
        }
        
        /* Footer */
        footer {
            background-color: var(--dark);
            color: white;
            padding: 60px 0 20px;
        }
        
        .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .footer-section h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: white;
            font-weight: 600;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #ddd;
            text-decoration: none;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .footer-links a:hover {
            color: var(--secondary);
            padding-left: 5px;
        }
        
        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .contact-item i {
            color: var(--secondary);
            width: 20px;
        }
        
        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-link {
            width: 40px;
            height: 40px;
            background-color: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .social-link:hover {
            background-color: var(--secondary);
            transform: translateY(-3px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #aaa;
            font-size: 14px;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            background-color: white;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(0,0,0,0.2);
            animation: slideUp 0.3s ease;
        }
        
        .modal-header {
            padding: 25px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            color: var(--dark);
            font-size: 22px;
            font-weight: 600;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: var(--transition);
        }
        
        .close-modal:hover {
            background-color: rgba(0,0,0,0.05);
            color: var(--dark);
        }
        
        .modal-body {
            padding: 25px;
        }
        
        /* Cart Modal */
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .cart-item-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }
        
        .cart-item-image {
            width: 60px;
            height: 60px;
            background-size: cover;
            background-position: center;
            border-radius: 6px;
        }
        
        .cart-item-details {
            flex: 1;
        }
        
        .cart-item-name {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .cart-item-price {
            color: var(--primary);
            font-weight: 600;
        }
        
        .cart-item-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: #f8f9fa;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quantity {
            min-width: 30px;
            text-align: center;
        }
        
        .remove-item {
            color: var(--danger);
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
        }
        
        .remove-item:hover {
            background-color: rgba(220, 53, 69, 0.1);
        }
        
        .cart-summary {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #eee;
        }
        
        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .summary-total {
            font-weight: 700;
            font-size: 20px;
            color: var(--primary);
        }
        
        /* Checkout Modal */
        .checkout-step {
            margin-bottom: 25px;
        }
        
        .step-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .step-number {
            background-color: var(--primary);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(46, 125, 50, 0.1);
        }
        
        .payment-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .payment-option {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .payment-option:hover, .payment-option.selected {
            border-color: var(--primary);
            background-color: rgba(46, 125, 50, 0.05);
        }
        
        .payment-icon-sm {
            font-size: 30px;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        /* Login Modal */
        .auth-tabs {
            display: flex;
            border-bottom: 1px solid #eee;
            margin-bottom: 25px;
        }
        
        .auth-tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            color: #666;
        }
        
        .auth-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .hero-title {
                font-size: 40px;
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-wrap: wrap;
            }
            
            .search-container {
                order: 3;
                width: 100%;
                margin-top: 15px;
            }
            
            .mobile-menu-btn {
                display: block;
            }
            
            .nav-links {
                position: fixed;
                top: 0;
                left: -100%;
                width: 280px;
                height: 100vh;
                background-color: var(--primary);
                flex-direction: column;
                padding-top: 80px;
                transition: var(--transition);
                z-index: 1001;
            }
            
            .nav-links.active {
                left: 0;
            }
            
            .nav-link {
                padding: 15px 25px;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            
            .hero-title {
                font-size: 32px;
            }
            
            .hero-subtitle {
                font-size: 18px;
            }
            
            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .section-title {
                font-size: 24px;
            }
            
            .featured-content h2 {
                font-size: 28px;
            }
            
            .modal-content {
                max-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .header-actions {
                gap: 10px;
            }
            
            .action-text {
                display: none;
            }
            
            .categories-grid {
                grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            }
            
            .products-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }
            
            .product-image {
                height: 150px;
            }
            
            .product-name {
                font-size: 14px;
                height: 38px;
            }
            
            .product-description {
                display: none;
            }
            
            .featured-grid {
                grid-template-columns: 1fr;
            }
            
            .featured-image {
                height: 200px;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0,0,0,.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Announcement Bar -->
    <div class="announcement-bar">
        <span>üéâ Free delivery on orders over K200 in Lusaka! | Call us: +260 211 123456</span>
    </div>
    
    <!-- Main Header -->
    <header class="main-header">
        <div class="header-container">
            <!-- Logo -->
            <a href="#" class="logo">
                <div class="logo-icon">
                    <i class="fas fa-shopping-cart"></i>
                </div>
                <div class="logo-text">
                    <h1>Kavency <span>Super Market</span></h1>
                    <p>Fresh Groceries Delivered</p>
                </div>
            </a>
            
            <!-- Search Bar -->
            <div class="search-container">
                <div class="search-bar">
                    <input type="text" class="search-input" placeholder="Search for fresh produce, meat, dairy..." id="searchInput">
                    <button class="search-btn" onclick="performSearch()">
                        <i class="fas fa-search"></i> Search
                    </button>
                </div>
            </div>
            
            <!-- Header Actions -->
            <div class="header-actions">
                <a href="#" class="action-btn" onclick="openLoginModal()">
                    <div class="action-icon">
                        <i class="fas fa-user"></i>
                    </div>
                    <span class="action-text">Account</span>
                </a>
                <a href="#" class="action-btn" onclick="openCartModal()">
                    <div class="action-icon">
                        <i class="fas fa-shopping-cart"></i>
                        <div class="cart-count" id="cartCount">0</div>
                    </div>
                    <span class="action-text">Cart</span>
                </a>
                <a href="Admin.html" class="action-btn" target="_blank">
                    <div class="action-icon">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <span class="action-text">Admin</span>
                </a>
            </div>
        </div>
        
        <!-- Navigation -->
        <nav class="main-nav">
            <div class="nav-container">
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                    <i class="fas fa-bars"></i>
                </button>
                
                <ul class="nav-links" id="navLinks">
                    <li><a href="#" class="nav-link active" onclick="showSection('home')"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('shop')"><i class="fas fa-store"></i> Shop All</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('categories')"><i class="fas fa-list"></i> Categories</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('specials')"><i class="fas fa-tag"></i> Weekly Specials</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('recipes')"><i class="fas fa-utensils"></i> Recipes</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('about')"><i class="fas fa-info-circle"></i> About Us</a></li>
                    <li><a href="#" class="nav-link" onclick="showSection('contact')"><i class="fas fa-phone"></i> Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>
    
    <!-- Main Content -->
    <main>
        <!-- Hero Section -->
        <section class="hero-section" id="homeSection">
            <div class="hero-content">
                <h1 class="hero-title">Fresh Groceries Delivered to Your Doorstep</h1>
                <p class="hero-subtitle">Shop online from Zambia's favorite supermarket. We deliver fresh produce, quality meat, pantry staples, and more right to your home.</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="showSection('shop')">
                        <i class="fas fa-shopping-cart"></i> Start Shopping Now
                    </button>
                    <button class="btn btn-outline" onclick="showSection('specials')">
                        <i class="fas fa-tag"></i> View Weekly Specials
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Featured Categories -->
        <section class="section" id="categoriesSection" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Shop by Category</h2>
                <button class="btn btn-secondary" onclick="showSection('shop')">
                    View All Categories <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            
            <div class="categories-grid" id="categoriesGrid">
                <!-- Categories will be loaded dynamically -->
            </div>
        </section>
        
        <!-- Featured Products -->
        <section class="section" id="shopSection" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Featured Products</h2>
                <div style="display: flex; gap: 10px;">
                    <select class="form-control" style="width: 150px;" id="categoryFilter" onchange="filterProducts()">
                        <option value="">All Categories</option>
                    </select>
                    <select class="form-control" style="width: 150px;" id="sortFilter" onchange="sortProducts()">
                        <option value="featured">Featured</option>
                        <option value="price-low">Price: Low to High</option>
                        <option value="price-high">Price: High to Low</option>
                        <option value="name">Name: A to Z</option>
                    </select>
                </div>
            </div>
            
            <div class="products-grid" id="productsGrid">
                <!-- Products will be loaded dynamically -->
            </div>
            
            <div style="text-align: center; margin-top: 40px;">
                <button class="btn btn-primary" onclick="loadMoreProducts()">
                    <i class="fas fa-plus"></i> Load More Products
                </button>
            </div>
        </section>
        
        <!-- About Section -->
        <section class="featured-section" id="aboutSection" style="display: none;">
            <div class="featured-grid">
                <div class="featured-content">
                    <h2>Why Choose Kavency Super Market?</h2>
                    <p>We're committed to providing the freshest groceries with the convenience of home delivery. Our team carefully selects each product to ensure quality and freshness.</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
                        <div>
                            <h3 style="color: var(--primary); margin-bottom: 10px;">üèÜ Quality Guaranteed</h3>
                            <p style="font-size: 14px;">Freshness guaranteed or your money back</p>
                        </div>
                        <div>
                            <h3 style="color: var(--primary); margin-bottom: 10px;">üöö Fast Delivery</h3>
                            <p style="font-size: 14px;">Same-day delivery in Lusaka</p>
                        </div>
                        <div>
                            <h3 style="color: var(--primary); margin-bottom: 10px;">üí≥ Secure Payment</h3>
                            <p style="font-size: 14px;">Multiple payment options available</p>
                        </div>
                        <div>
                            <h3 style="color: var(--primary); margin-bottom: 10px;">üìû 24/7 Support</h3>
                            <p style="font-size: 14px;">Customer support always available</p>
                        </div>
                    </div>
                </div>
                <div class="featured-image" style="background-image: url('https://images.unsplash.com/photo-1583258292688-d0213dc5a3a8?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80');"></div>
            </div>
        </section>
        
        <!-- Weekly Specials -->
        <section class="section" id="specialsSection" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">Weekly Specials</h2>
                <div class="sale-badge" style="background-color: var(--danger); color: white; padding: 8px 20px; border-radius: 30px; font-weight: 600;">
                    <i class="fas fa-fire"></i> Limited Time Offer
                </div>
            </div>
            
            <div class="products-grid" id="specialsGrid">
                <!-- Special products will be loaded dynamically -->
            </div>
        </section>
        
        <!-- Payment Methods -->
        <section class="payment-section">
            <div class="section-header" style="border: none; margin-bottom: 0;">
                <h2 class="section-title">We Accept</h2>
            </div>
            <p style="text-align: center; color: #666; margin-bottom: 20px;">Secure payment methods for your convenience</p>
            
            <div class="payment-grid">
                <div class="payment-method">
                    <i class="fas fa-mobile-alt payment-icon"></i>
                    <span class="payment-name">MTN Mobile Money</span>
                </div>
                <div class="payment-method">
                    <i class="fas fa-signal payment-icon"></i>
                    <span class="payment-name">Airtel Money</span>
                </div>
                <div class="payment-method">
                    <i class="fas fa-wifi payment-icon"></i>
                    <span class="payment-name">Zamtel Kwacha</span>
                </div>
                <div class="payment-method">
                    <i class="fas fa-university payment-icon"></i>
                    <span class="payment-name">Zanaco Transfer</span>
                </div>
                <div class="payment-method">
                    <i class="fas fa-credit-card payment-icon"></i>
                    <span class="payment-name">FNB Transfer</span>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3>Kavency Super Market</h3>
                <p style="color: #ddd; margin-bottom: 20px; line-height: 1.6;">Your trusted partner for fresh groceries since 2010. Now delivering to your doorstep across Lusaka.</p>
                <div class="social-links">
                    <a href="#" class="social-link"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    <a href="#" class="social-link"><i class="fab fa-whatsapp"></i></a>
                </div>
            </div>
            
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="#" onclick="showSection('home')"><i class="fas fa-chevron-right"></i> Home</a></li>
                    <li><a href="#" onclick="showSection('shop')"><i class="fas fa-chevron-right"></i> Shop Online</a></li>
                    <li><a href="#" onclick="showSection('specials')"><i class="fas fa-chevron-right"></i> Weekly Specials</a></li>
                    <li><a href="#" onclick="showSection('recipes')"><i class="fas fa-chevron-right"></i> Recipes</a></li>
                    <li><a href="#" onclick="showSection('about')"><i class="fas fa-chevron-right"></i> About Us</a></li>
                    <li><a href="Admin.html" target="_blank"><i class="fas fa-chevron-right"></i> Admin Panel</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h3>Contact Info</h3>
                <div class="contact-info">
                    <div class="contact-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>123 Great East Road, Lusaka</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-phone"></i>
                        <span>+260 211 123456</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-envelope"></i>
                        <span>info@kavency.co.zm</span>
                    </div>
                    <div class="contact-item">
                        <i class="fas fa-clock"></i>
                        <span>Mon-Sun: 7:00 AM - 9:00 PM</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="copyright">
            <p>&copy; 2023 Kavency Super Market. All rights reserved. | Designed with ‚ù§Ô∏è for Zambia</p>
        </div>
    </footer>
    
    <!-- Cart Modal -->
    <div class="modal" id="cartModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Your Shopping Cart</h2>
                <button class="close-modal" onclick="closeCartModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="cartItems">
                    <!-- Cart items will be loaded dynamically -->
                </div>
                
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal</span>
                        <span id="cartSubtotal">K0.00</span>
                    </div>
                    <div class="summary-row">
                        <span>Delivery Fee</span>
                        <span id="deliveryFee">K15.00</span>
                    </div>
                    <div class="summary-row summary-total">
                        <span>Total</span>
                        <span id="cartTotal">K15.00</span>
                    </div>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; margin-top: 20px; padding: 16px;" onclick="proceedToCheckout()">
                    <i class="fas fa-shopping-bag"></i> Proceed to Checkout
                </button>
                
                <button class="btn btn-secondary" style="width: 100%; margin-top: 10px;" onclick="continueShopping()">
                    <i class="fas fa-arrow-left"></i> Continue Shopping
                </button>
            </div>
        </div>
    </div>
    
    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Checkout</h2>
                <button class="close-modal" onclick="closeCheckoutModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="checkout-step">
                    <div class="step-title">
                        <span class="step-number">1</span>
                        <span>Delivery Information</span>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Full Name *</label>
                        <input type="text" class="form-control" id="checkoutName" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone Number *</label>
                        <input type="tel" class="form-control" id="checkoutPhone" placeholder="Enter your phone number" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Delivery Address *</label>
                        <textarea class="form-control" id="checkoutAddress" placeholder="Enter your complete delivery address" rows="3" required></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Delivery Time Slot *</label>
                        <select class="form-control" id="deliveryTime" required>
                            <option value="">Select delivery time</option>
                            <option value="9am-12pm">Today 9:00 AM - 12:00 PM</option>
                            <option value="12pm-3pm">Today 12:00 PM - 3:00 PM</option>
                            <option value="3pm-6pm">Today 3:00 PM - 6:00 PM</option>
                            <option value="6pm-9pm">Today 6:00 PM - 9:00 PM</option>
                            <option value="tomorrow">Tomorrow 9:00 AM - 6:00 PM</option>
                        </select>
                    </div>
                </div>
                
                <div class="checkout-step">
                    <div class="step-title">
                        <span class="step-number">2</span>
                        <span>Payment Method</span>
                    </div>
                    <div class="payment-options">
                        <div class="payment-option" onclick="selectPayment('mtn')">
                            <i class="fas fa-mobile-alt payment-icon-sm"></i>
                            <p>MTN Money</p>
                        </div>
                        <div class="payment-option" onclick="selectPayment('airtel')">
                            <i class="fas fa-signal payment-icon-sm"></i>
                            <p>Airtel Money</p>
                        </div>
                        <div class="payment-option" onclick="selectPayment('zamtel')">
                            <i class="fas fa-wifi payment-icon-sm"></i>
                            <p>Zamtel Kwacha</p>
                        </div>
                        <div class="payment-option" onclick="selectPayment('bank')">
                            <i class="fas fa-university payment-icon-sm"></i>
                            <p>Bank Transfer</p>
                        </div>
                    </div>
                    
                    <div id="paymentInstructions" style="display: none; margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px;">
                        <h4 style="margin-bottom: 10px; color: var(--primary);">Payment Instructions:</h4>
                        <p id="instructionsText" style="color: #666;"></p>
                    </div>
                </div>
                
                <div class="checkout-step">
                    <div class="step-title">
                        <span class="step-number">3</span>
                        <span>Order Summary</span>
                    </div>
                    <div id="checkoutSummary" style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <!-- Order summary will be loaded here -->
                    </div>
                </div>
                
                <button class="btn btn-primary" style="width: 100%; padding: 16px; font-size: 18px;" onclick="placeOrder()">
                    <i class="fas fa-check-circle"></i> Place Order Now
                </button>
                
                <p style="text-align: center; margin-top: 15px; font-size: 14px; color: #666;">
                    By placing your order, you agree to our <a href="#" style="color: var(--primary);">Terms & Conditions</a>
                </p>
            </div>
        </div>
    </div>
    
    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Welcome to Kavency</h2>
                <button class="close-modal" onclick="closeLoginModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <div class="auth-tab active" onclick="switchAuthTab('login')">Login</div>
                    <div class="auth-tab" onclick="switchAuthTab('register')">Register</div>
                </div>
                
                <div id="loginForm">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="Enter your password">
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="login()">
                        <i class="fas fa-sign-in-alt"></i> Login to Account
                    </button>
                    <p style="text-align: center; margin-top: 15px;">
                        <a href="#" style="color: var(--primary);">Forgot password?</a>
                    </p>
                </div>
                
                <div id="registerForm" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="registerName" placeholder="Enter your full name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-control" id="registerEmail" placeholder="Enter your email">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Phone Number</label>
                        <input type="tel" class="form-control" id="registerPhone" placeholder="Enter your phone number">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-control" id="registerPassword" placeholder="Create a password">
                    </div>
                    <button class="btn btn-primary" style="width: 100%;" onclick="register()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </div>
                
                <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee;">
                    <p style="color: #666; margin-bottom: 10px;">Access Admin Panel</p>
                    <a href="Admin.html" class="btn btn-secondary" style="width: 100%;" target="_blank">
                        <i class="fas fa-tachometer-alt"></i> Go to Admin Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Order Success Modal -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 style="color: var(--success);"><i class="fas fa-check-circle"></i> Order Successful!</h2>
                <button class="close-modal" onclick="closeSuccessModal()">&times;</button>
            </div>
            <div class="modal-body" style="text-align: center;">
                <div style="font-size: 80px; color: var(--success); margin: 20px 0;">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h3 style="margin-bottom: 15px;">Thank you for your order!</h3>
                <p style="color: #666; margin-bottom: 10px;">Your order <strong id="orderIdDisplay"></strong> has been placed successfully.</p>
                <p style="color: #666; margin-bottom: 20px;">We'll send you a confirmation SMS with delivery details.</p>
                <div style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0;">
                    <p><strong>Delivery Time:</strong> <span id="deliveryTimeDisplay"></span></p>
                    <p><strong>Total Amount:</strong> <span id="orderTotalDisplay"></span></p>
                    <p><strong>Payment Method:</strong> <span id="paymentMethodDisplay"></span></p>
                </div>
                <button class="btn btn-primary" onclick="continueShopping()" style="width: 100%;">
                    <i class="fas fa-shopping-cart"></i> Continue Shopping
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== GLOBAL VARIABLES ====================
        let cart = JSON.parse(localStorage.getItem('kavency_cart')) || [];
        let products = [];
        let categories = [];
        let user = JSON.parse(localStorage.getItem('kavency_user')) || null;
        let selectedPayment = null;
        let currentSection = 'home';
        let productsDisplayed = 0;
        const productsPerPage = 8;

        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Load data from admin panel
            loadProductsFromAdmin();
            loadCategoriesFromAdmin();
            
            // Update cart count
            updateCartCount();
            
            // Show home section
            showSection('home');
            
            // Load categories for shop page
            loadCategoryFilter();
            
            // Set up event listeners
            setupEventListeners();
            
            // Check if there are new products
            checkForUpdates();
        });

        // ==================== DATA LOADING ====================
        function loadProductsFromAdmin() {
            try {
                const adminProducts = JSON.parse(localStorage.getItem('kavency_products'));
                if (adminProducts && adminProducts.length > 0) {
                    products = adminProducts;
                    displayFeaturedProducts();
                    displaySpecialProducts();
                } else {
                    // Default products if none in admin
                    loadDefaultProducts();
                }
            } catch (error) {
                console.error('Error loading products:', error);
                loadDefaultProducts();
            }
        }

        function loadDefaultProducts() {
            products = [
                {
                    id: 'P001',
                    name: 'Fresh Tomatoes (1kg)',
                    category: 'cat1',
                    price: 12.99,
                    stock: 45,
                    description: 'Locally grown, ripe tomatoes from Zambian farms. Perfect for salads, sauces, and cooking.',
                    sku: 'TOM-001',
                    weight: 1.0,
                    discount: 0,
                    featured: 'yes',
                    images: ['https://images.unsplash.com/photo-1586201375761-83865001e31c?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80']
                },
                {
                    id: 'P002',
                    name: 'Chicken Breasts (1kg)',
                    category: 'cat2',
                    price: 45.99,
                    stock: 22,
                    description: 'Premium skinless, boneless chicken breasts. Fresh and tender, perfect for grilling or baking.',
                    sku: 'CHK-001',
                    weight: 1.0,
                    discount: 0,
                    featured: 'yes',
                    images: ['https://images.unsplash.com/photo-1621996346565-e3dbc353d2a5?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80']
                },
                {
                    id: 'P003',
                    name: 'Fresh Milk (2L)',
                    category: 'cat3',
                    price: 18.50,
                    stock: 3,
                    description: 'Full cream pasteurized milk. Rich in calcium and vitamins, perfect for your daily needs.',
                    sku: 'MLK-001',
                    weight: 2.0,
                    discount: 0,
                    featured: 'no',
                    images: ['https://images.unsplash.com/photo-1563636619-e9143da7973b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80']
                },
                {
                    id: 'P004',
                    name: 'Brown Bread',
                    category: 'cat4',
                    price: 8.99,
                    stock: 25,
                    description: 'Freshly baked whole wheat brown bread. High in fiber and perfect for breakfast.',
                    sku: 'BRD-001',
                    weight: 0.5,
                    discount: 10,
                    featured: 'yes',
                    images: ['https://images.unsplash.com/photo-1608190003443-86ab6a3e21a7?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80']
                },
                {
                    id: 'P005',
                    name: 'Fresh Apples (1kg)',
                    category: 'cat1',
                    price: 15.99,
                    stock: 30,
                    description: 'Crisp and juicy apples, perfect for snacking or baking. Imported from South Africa.',
                    sku: 'APL-001',
                    weight: 1.0,
                    discount: 0,
                    featured: 'yes',
                    images: ['https://images.unsplash.com/photo-1568702846914-96b305d2aaeb?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80']
                }
            ];
            displayFeaturedProducts();
            displaySpecialProducts();
        }

        function loadCategoriesFromAdmin() {
            try {
                const adminCategories = JSON.parse(localStorage.getItem('kavency_categories'));
                if (adminCategories && adminCategories.length > 0) {
                    categories = adminCategories;
                    displayCategories();
                } else {
                    loadDefaultCategories();
                }
            } catch (error) {
                console.error('Error loading categories:', error);
                loadDefaultCategories();
            }
        }

        function loadDefaultCategories() {
            categories = [
                { id: 'cat1', name: 'Fresh Produce', description: 'Fruits, vegetables, herbs & more', productCount: 156 },
                { id: 'cat2', name: 'Meat & Seafood', description: 'Quality cuts, poultry & fresh fish', productCount: 89 },
                { id: 'cat3', name: 'Dairy & Eggs', description: 'Milk, cheese, yogurt & fresh eggs', productCount: 67 },
                { id: 'cat4', name: 'Bakery', description: 'Fresh bread, cakes & pastries', productCount: 45 },
                { id: 'cat5', name: 'Beverages', description: 'Soft drinks, juices & water', productCount: 112 },
                { id: 'cat6', name: 'Household', description: 'Cleaning and household items', productCount: 203 }
            ];
            displayCategories();
        }

        function checkForUpdates() {
            try {
                const lastUpdate = localStorage.getItem('kavency_store_updated');
                if (lastUpdate) {
                    // Reload products if admin has updated them
                    const now = new Date();
                    const updateTime = new Date(lastUpdate);
                    const diffMinutes = (now - updateTime) / (1000 * 60);
                    
                    if (diffMinutes < 5) { // If updated in last 5 minutes
                        loadProductsFromAdmin();
                        loadCategoriesFromAdmin();
                        localStorage.removeItem('kavency_store_updated');
                    }
                }
            } catch (error) {
                console.error('Error checking for updates:', error);
            }
        }

        // ==================== NAVIGATION FUNCTIONS ====================
        function showSection(sectionId) {
            try {
                // Hide all sections
                const sections = ['home', 'shop', 'categories', 'specials', 'about'];
                sections.forEach(id => {
                    const section = document.getElementById(id + 'Section');
                    if (section) section.style.display = 'none';
                });
                
                // Update navigation
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                
                // Show selected section
                const targetSection = document.getElementById(sectionId + 'Section');
                if (targetSection) {
                    targetSection.style.display = 'block';
                }
                
                // Add active class to navigation link
                const navLink = document.querySelector(`.nav-link[onclick*="${sectionId}"]`);
                if (navLink) {
                    navLink.classList.add('active');
                }
                
                // Update current section
                currentSection = sectionId;
                
                // Scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Close mobile menu
                const navLinks = document.getElementById('navLinks');
                if (navLinks) navLinks.classList.remove('active');
                
                // Load section-specific content
                switch(sectionId) {
                    case 'shop':
                        loadShopProducts();
                        break;
                    case 'categories':
                        displayCategories();
                        break;
                    case 'specials':
                        displaySpecialProducts();
                        break;
                }
            } catch (error) {
                console.error('Error showing section:', error);
            }
        }

        function toggleMobileMenu() {
            const navLinks = document.getElementById('navLinks');
            if (navLinks) {
                navLinks.classList.toggle('active');
            }
        }

        // ==================== PRODUCT DISPLAY FUNCTIONS ====================
        function displayFeaturedProducts() {
            try {
                const featuredProducts = products.filter(p => p.featured === 'yes');
                const grid = document.getElementById('productsGrid');
                
                if (!grid) return;
                
                if (currentSection === 'shop') {
                    loadShopProducts();
                    return;
                }
                
                grid.innerHTML = '';
                productsDisplayed = Math.min(featuredProducts.length, productsPerPage);
                
                featuredProducts.slice(0, productsPerPage).forEach(product => {
                    const category = categories.find(c => c.id === product.category) || { name: 'Uncategorized' };
                    const discountedPrice = product.discount > 0 ? product.price * (1 - product.discount / 100) : null;
                    
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.innerHTML = `
                        ${product.discount > 0 ? `<div class="product-badge">-${product.discount}%</div>` : ''}
                        <div class="product-image" style="background-image: url('${product.images[0]}');">
                            <div class="product-overlay">
                                <button class="quick-view-btn" onclick="quickView('${product.id}')">
                                    <i class="fas fa-eye"></i> Quick View
                                </button>
                            </div>
                        </div>
                        <div class="product-content">
                            <div class="product-category">${category.name}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description ? product.description.substring(0, 60) + '...' : ''}</p>
                            <div class="product-price">
                                <div>
                                    <span class="price-current">K${discountedPrice ? discountedPrice.toFixed(2) : product.price.toFixed(2)}</span>
                                    ${discountedPrice ? `<span class="price-old">K${product.price.toFixed(2)}</span>` : ''}
                                </div>
                                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(productCard);
                });
            } catch (error) {
                console.error('Error displaying featured products:', error);
            }
        }

        function displaySpecialProducts() {
            try {
                const specialProducts = products.filter(p => p.discount > 0);
                const grid = document.getElementById('specialsGrid');
                
                if (!grid) return;
                
                grid.innerHTML = '';
                
                specialProducts.forEach(product => {
                    const category = categories.find(c => c.id === product.category) || { name: 'Uncategorized' };
                    const discountedPrice = product.price * (1 - product.discount / 100);
                    
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.innerHTML = `
                        <div class="product-badge">-${product.discount}%</div>
                        <div class="product-image" style="background-image: url('${product.images[0]}');">
                            <div class="product-overlay">
                                <button class="quick-view-btn" onclick="quickView('${product.id}')">
                                    <i class="fas fa-eye"></i> Quick View
                                </button>
                            </div>
                        </div>
                        <div class="product-content">
                            <div class="product-category">${category.name}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description ? product.description.substring(0, 60) + '...' : ''}</p>
                            <div class="product-price">
                                <div>
                                    <span class="price-current">K${discountedPrice.toFixed(2)}</span>
                                    <span class="price-old">K${product.price.toFixed(2)}</span>
                                </div>
                                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(productCard);
                });
            } catch (error) {
                console.error('Error displaying special products:', error);
            }
        }

        function displayCategories() {
            try {
                const grid = document.getElementById('categoriesGrid');
                if (!grid) return;
                
                grid.innerHTML = '';
                
                categories.forEach(category => {
                    const categoryCard = document.createElement('a');
                    categoryCard.className = 'category-card';
                    categoryCard.href = '#';
                    categoryCard.onclick = function(e) {
                        e.preventDefault();
                        showSection('shop');
                        const categoryFilter = document.getElementById('categoryFilter');
                        if (categoryFilter) categoryFilter.value = category.id;
                        filterProducts();
                    };
                    
                    // Set different background images for different categories
                    let imageUrl = '';
                    switch(category.id) {
                        case 'cat1': imageUrl = 'https://images.unsplash.com/photo-1540420773420-3366772f4999?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'; break;
                        case 'cat2': imageUrl = 'https://images.unsplash.com/photo-1546833999-b9f581a1996d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'; break;
                        case 'cat3': imageUrl = 'https://images.unsplash.com/photo-1550583724-b2692b85b150?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'; break;
                        case 'cat4': imageUrl = 'https://images.unsplash.com/photo-1509440159596-0249088772ff?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'; break;
                        default: imageUrl = 'https://images.unsplash.com/photo-1556909114-f6e7ad7d3136?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80';
                    }
                    
                    categoryCard.innerHTML = `
                        <div class="category-image" style="background-image: url('${imageUrl}');"></div>
                        <div class="category-content">
                            <h3 class="category-name">${category.name}</h3>
                            <p class="category-count">${category.productCount} products</p>
                        </div>
                    `;
                    grid.appendChild(categoryCard);
                });
            } catch (error) {
                console.error('Error displaying categories:', error);
            }
        }

        function loadShopProducts() {
            try {
                const grid = document.getElementById('productsGrid');
                if (!grid) return;
                
                grid.innerHTML = '';
                
                // Get filter values
                const categoryFilter = document.getElementById('categoryFilter');
                const sortFilter = document.getElementById('sortFilter');
                
                let categoryValue = '';
                let sortValue = 'featured';
                
                if (categoryFilter) categoryValue = categoryFilter.value;
                if (sortFilter) sortValue = sortFilter.value;
                
                // Filter products
                let filteredProducts = products;
                if (categoryValue) {
                    filteredProducts = filteredProducts.filter(p => p.category === categoryValue);
                }
                
                // Sort products
                switch(sortValue) {
                    case 'price-low':
                        filteredProducts.sort((a, b) => {
                            const priceA = a.discount > 0 ? a.price * (1 - a.discount / 100) : a.price;
                            const priceB = b.discount > 0 ? b.price * (1 - b.discount / 100) : b.price;
                            return priceA - priceB;
                        });
                        break;
                    case 'price-high':
                        filteredProducts.sort((a, b) => {
                            const priceA = a.discount > 0 ? a.price * (1 - a.discount / 100) : a.price;
                            const priceB = b.discount > 0 ? b.price * (1 - b.discount / 100) : b.price;
                            return priceB - priceA;
                        });
                        break;
                    case 'name':
                        filteredProducts.sort((a, b) => a.name.localeCompare(b.name));
                        break;
                    case 'featured':
                    default:
                        filteredProducts.sort((a, b) => (b.featured === 'yes') - (a.featured === 'yes'));
                        break;
                }
                
                // Display products
                productsDisplayed = Math.min(filteredProducts.length, productsPerPage);
                
                filteredProducts.slice(0, productsDisplayed).forEach(product => {
                    const category = categories.find(c => c.id === product.category) || { name: 'Uncategorized' };
                    const discountedPrice = product.discount > 0 ? product.price * (1 - product.discount / 100) : null;
                    
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.innerHTML = `
                        ${product.discount > 0 ? `<div class="product-badge">-${product.discount}%</div>` : ''}
                        <div class="product-image" style="background-image: url('${product.images[0]}');">
                            <div class="product-overlay">
                                <button class="quick-view-btn" onclick="quickView('${product.id}')">
                                    <i class="fas fa-eye"></i> Quick View
                                </button>
                            </div>
                        </div>
                        <div class="product-content">
                            <div class="product-category">${category.name}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description ? product.description.substring(0, 60) + '...' : ''}</p>
                            <div class="product-price">
                                <div>
                                    <span class="price-current">K${discountedPrice ? discountedPrice.toFixed(2) : product.price.toFixed(2)}</span>
                                    ${discountedPrice ? `<span class="price-old">K${product.price.toFixed(2)}</span>` : ''}
                                </div>
                                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(productCard);
                });
                
                // Show/hide load more button
                const loadMoreBtn = grid.nextElementSibling ? grid.nextElementSibling.querySelector('button') : null;
                if (loadMoreBtn) {
                    if (filteredProducts.length <= productsDisplayed) {
                        loadMoreBtn.style.display = 'none';
                    } else {
                        loadMoreBtn.style.display = 'inline-block';
                    }
                }
            } catch (error) {
                console.error('Error loading shop products:', error);
            }
        }

        function filterProducts() {
            loadShopProducts();
        }

        function sortProducts() {
            loadShopProducts();
        }

        function loadMoreProducts() {
            try {
                const grid = document.getElementById('productsGrid');
                if (!grid) return;
                
                const categoryFilter = document.getElementById('categoryFilter');
                let categoryValue = '';
                if (categoryFilter) categoryValue = categoryFilter.value;
                
                let filteredProducts = products;
                if (categoryValue) {
                    filteredProducts = filteredProducts.filter(p => p.category === categoryValue);
                }
                
                const nextProducts = filteredProducts.slice(productsDisplayed, productsDisplayed + productsPerPage);
                
                nextProducts.forEach(product => {
                    const category = categories.find(c => c.id === product.category) || { name: 'Uncategorized' };
                    const discountedPrice = product.discount > 0 ? product.price * (1 - product.discount / 100) : null;
                    
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.innerHTML = `
                        ${product.discount > 0 ? `<div class="product-badge">-${product.discount}%</div>` : ''}
                        <div class="product-image" style="background-image: url('${product.images[0]}');">
                            <div class="product-overlay">
                                <button class="quick-view-btn" onclick="quickView('${product.id}')">
                                    <i class="fas fa-eye"></i> Quick View
                                </button>
                            </div>
                        </div>
                        <div class="product-content">
                            <div class="product-category">${category.name}</div>
                            <h3 class="product-name">${product.name}</h3>
                            <p class="product-description">${product.description ? product.description.substring(0, 60) + '...' : ''}</p>
                            <div class="product-price">
                                <div>
                                    <span class="price-current">K${discountedPrice ? discountedPrice.toFixed(2) : product.price.toFixed(2)}</span>
                                    ${discountedPrice ? `<span class="price-old">K${product.price.toFixed(2)}</span>` : ''}
                                </div>
                                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(productCard);
                });
                
                productsDisplayed += nextProducts.length;
                
                if (productsDisplayed >= filteredProducts.length) {
                    const loadMoreBtn = grid.nextElementSibling ? grid.nextElementSibling.querySelector('button') : null;
                    if (loadMoreBtn) {
                        loadMoreBtn.style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('Error loading more products:', error);
            }
        }

        function loadCategoryFilter() {
            try {
                const filter = document.getElementById('categoryFilter');
                if (!filter) return;
                
                filter.innerHTML = '<option value="">All Categories</option>';
                
                categories.forEach(category => {
                    filter.innerHTML += `<option value="${category.id}">${category.name}</option>`;
                });
            } catch (error) {
                console.error('Error loading category filter:', error);
            }
        }

        // ==================== CART FUNCTIONS ====================
        function addToCart(productId) {
            try {
                const product = products.find(p => p.id === productId);
                if (!product) return;
                
                // Check if product is already in cart
                const existingItem = cart.find(item => item.id === productId);
                
                if (existingItem) {
                    if (existingItem.quantity < product.stock) {
                        existingItem.quantity++;
                    } else {
                        alert(`Sorry, only ${product.stock} items available in stock.`);
                        return;
                    }
                } else {
                    if (product.stock > 0) {
                        cart.push({
                            id: product.id,
                            name: product.name,
                            price: product.discount > 0 ? product.price * (1 - product.discount / 100) : product.price,
                            originalPrice: product.price,
                            discount: product.discount,
                            image: product.images[0],
                            quantity: 1,
                            maxStock: product.stock
                        });
                    } else {
                        alert('Sorry, this product is out of stock.');
                        return;
                    }
                }
                
                // Save cart to localStorage
                localStorage.setItem('kavency_cart', JSON.stringify(cart));
                
                // Update cart count
                updateCartCount();
                
                // Show success message
                showNotification(`${product.name} added to cart!`, 'success');
                
                // If cart modal is open, update it
                if (document.getElementById('cartModal').style.display === 'flex') {
                    updateCartModal();
                }
            } catch (error) {
                console.error('Error adding to cart:', error);
                alert('Error adding product to cart. Please try again.');
            }
        }

        function updateCartCount() {
            try {
                const totalItems = cart.reduce((sum, item) => sum + (item.quantity || 0), 0);
                const cartCountElement = document.getElementById('cartCount');
                if (cartCountElement) {
                    cartCountElement.textContent = totalItems;
                }
            } catch (error) {
                console.error('Error updating cart count:', error);
            }
        }

        function updateCartModal() {
            try {
                const cartItemsDiv = document.getElementById('cartItems');
                if (!cartItemsDiv) return;
                
                cartItemsDiv.innerHTML = '';
                
                if (cart.length === 0) {
                    cartItemsDiv.innerHTML = `
                        <div style="text-align: center; padding: 40px 20px;">
                            <i class="fas fa-shopping-cart" style="font-size: 60px; color: #ddd; margin-bottom: 20px;"></i>
                            <h3 style="color: #666; margin-bottom: 10px;">Your cart is empty</h3>
                            <p style="color: #999;">Add some products to get started</p>
                        </div>
                    `;
                    const subtotalElement = document.getElementById('cartSubtotal');
                    const totalElement = document.getElementById('cartTotal');
                    if (subtotalElement) subtotalElement.textContent = 'K0.00';
                    if (totalElement) totalElement.textContent = 'K15.00';
                    return;
                }
                
                let subtotal = 0;
                
                cart.forEach((item, index) => {
                    const itemTotal = (item.price || 0) * (item.quantity || 0);
                    subtotal += itemTotal;
                    
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="cart-item-info">
                            <div class="cart-item-image" style="background-image: url('${item.image || ''}');"></div>
                            <div class="cart-item-details">
                                <div class="cart-item-name">${item.name || 'Product'}</div>
                                <div class="cart-item-price">K${(item.price || 0).toFixed(2)} each</div>
                            </div>
                        </div>
                        <div class="cart-item-actions">
                            <div class="quantity-control">
                                <button class="quantity-btn" onclick="updateQuantity(${index}, ${(item.quantity || 1) - 1})">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="quantity">${item.quantity || 1}</span>
                                <button class="quantity-btn" onclick="updateQuantity(${index}, ${(item.quantity || 1) + 1})">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <div style="min-width: 80px; text-align: right;">
                                <strong>K${itemTotal.toFixed(2)}</strong>
                            </div>
                            <button class="remove-item" onclick="removeFromCart(${index})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    cartItemsDiv.appendChild(cartItem);
                });
                
                const deliveryFee = 15.00;
                const total = subtotal + deliveryFee;
                
                const subtotalElement = document.getElementById('cartSubtotal');
                const totalElement = document.getElementById('cartTotal');
                
                if (subtotalElement) subtotalElement.textContent = 'K' + subtotal.toFixed(2);
                if (totalElement) totalElement.textContent = 'K' + total.toFixed(2);
            } catch (error) {
                console.error('Error updating cart modal:', error);
            }
        }

        function updateQuantity(index, newQuantity) {
            try {
                if (newQuantity < 1) {
                    removeFromCart(index);
                    return;
                }
                
                const item = cart[index];
                if (!item) return;
                
                if (newQuantity > (item.maxStock || 99)) {
                    alert(`Sorry, only ${item.maxStock || 99} items available in stock.`);
                    return;
                }
                
                cart[index].quantity = newQuantity;
                localStorage.setItem('kavency_cart', JSON.stringify(cart));
                updateCartCount();
                updateCartModal();
            } catch (error) {
                console.error('Error updating quantity:', error);
            }
        }

        function removeFromCart(index) {
            try {
                cart.splice(index, 1);
                localStorage.setItem('kavency_cart', JSON.stringify(cart));
                updateCartCount();
                updateCartModal();
            } catch (error) {
                console.error('Error removing from cart:', error);
            }
        }

        function clearCart() {
            try {
                cart = [];
                localStorage.setItem('kavency_cart', JSON.stringify(cart));
                updateCartCount();
                updateCartModal();
            } catch (error) {
                console.error('Error clearing cart:', error);
            }
        }

        // ==================== MODAL FUNCTIONS ====================
        function openCartModal() {
            try {
                updateCartModal();
                const modal = document.getElementById('cartModal');
                if (modal) modal.style.display = 'flex';
            } catch (error) {
                console.error('Error opening cart modal:', error);
            }
        }

        function closeCartModal() {
            try {
                const modal = document.getElementById('cartModal');
                if (modal) modal.style.display = 'none';
            } catch (error) {
                console.error('Error closing cart modal:', error);
            }
        }

        function openCheckoutModal() {
            try {
                if (cart.length === 0) {
                    alert('Your cart is empty. Add some products first.');
                    return;
                }
                
                // Pre-fill user info if available
                if (user) {
                    const nameInput = document.getElementById('checkoutName');
                    const phoneInput = document.getElementById('checkoutPhone');
                    if (nameInput) nameInput.value = user.name || '';
                    if (phoneInput) phoneInput.value = user.phone || '';
                }
                
                // Update checkout summary
                updateCheckoutSummary();
                
                closeCartModal();
                const modal = document.getElementById('checkoutModal');
                if (modal) modal.style.display = 'flex';
            } catch (error) {
                console.error('Error opening checkout modal:', error);
            }
        }

        function closeCheckoutModal() {
            try {
                const modal = document.getElementById('checkoutModal');
                if (modal) modal.style.display = 'none';
            } catch (error) {
                console.error('Error closing checkout modal:', error);
            }
        }

        function openLoginModal() {
            try {
                const modal = document.getElementById('loginModal');
                if (modal) modal.style.display = 'flex';
            } catch (error) {
                console.error('Error opening login modal:', error);
            }
        }

        function closeLoginModal() {
            try {
                const modal = document.getElementById('loginModal');
                if (modal) modal.style.display = 'none';
            } catch (error) {
                console.error('Error closing login modal:', error);
            }
        }

        function closeSuccessModal() {
            try {
                const modal = document.getElementById('successModal');
                if (modal) modal.style.display = 'none';
            } catch (error) {
                console.error('Error closing success modal:', error);
            }
        }

        function switchAuthTab(tab) {
            try {
                document.querySelectorAll('.auth-tab').forEach(tabEl => {
                    tabEl.classList.remove('active');
                });
                
                event.target.classList.add('active');
                
                const loginForm = document.getElementById('loginForm');
                const registerForm = document.getElementById('registerForm');
                
                if (tab === 'login') {
                    if (loginForm) loginForm.style.display = 'block';
                    if (registerForm) registerForm.style.display = 'none';
                } else {
                    if (loginForm) loginForm.style.display = 'none';
                    if (registerForm) registerForm.style.display = 'block';
                }
            } catch (error) {
                console.error('Error switching auth tab:', error);
            }
        }

        // ==================== CHECKOUT FUNCTIONS ====================
        function selectPayment(method) {
            try {
                selectedPayment = method;
                
                // Update UI
                document.querySelectorAll('.payment-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                const target = event.target.closest('.payment-option');
                if (target) target.classList.add('selected');
                
                // Show instructions
                const instructionsDiv = document.getElementById('paymentInstructions');
                const instructionsText = document.getElementById('instructionsText');
                
                if (instructionsDiv) instructionsDiv.style.display = 'block';
                if (!instructionsText) return;
                
                let instructions = '';
                switch(method) {
                    case 'mtn':
                        instructions = 'Please send payment to MTN Mobile Money number 0961 234 567. Use your order ID as reference.';
                        break;
                    case 'airtel':
                        instructions = 'Please send payment to Airtel Money number 0977 123 456. Use your order ID as reference.';
                        break;
                    case 'zamtel':
                        instructions = 'Please send payment to Zamtel Kwacha number 0955 789 012. Use your order ID as reference.';
                        break;
                    case 'bank':
                        instructions = 'Please transfer to Zanaco Account: 1234567890 (Kavency Super Market). Use your order ID as reference.';
                        break;
                }
                
                instructionsText.textContent = instructions;
            } catch (error) {
                console.error('Error selecting payment:', error);
            }
        }

        function updateCheckoutSummary() {
            try {
                const summaryDiv = document.getElementById('checkoutSummary');
                if (!summaryDiv) return;
                
                let subtotal = cart.reduce((sum, item) => sum + ((item.price || 0) * (item.quantity || 0)), 0);
                let deliveryFee = 15.00;
                let total = subtotal + deliveryFee;
                
                let summaryHTML = `
                    <div style="margin-bottom: 10px;">
                        <strong>Items (${cart.length}):</strong> K${subtotal.toFixed(2)}
                    </div>
                `;
                
                cart.forEach(item => {
                    summaryHTML += `
                        <div style="font-size: 14px; color: #666; margin-bottom: 5px;">
                            ${item.quantity || 1} √ó ${item.name || 'Product'}
                        </div>
                    `;
                });
                
                summaryHTML += `
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Subtotal:</span>
                            <span>K${subtotal.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                            <span>Delivery Fee:</span>
                            <span>K${deliveryFee.toFixed(2)}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 18px; color: var(--primary);">
                            <span>Total:</span>
                            <span>K${total.toFixed(2)}</span>
                        </div>
                    </div>
                `;
                
                summaryDiv.innerHTML = summaryHTML;
            } catch (error) {
                console.error('Error updating checkout summary:', error);
            }
        }

        function placeOrder() {
            try {
                // Validate form
                const nameInput = document.getElementById('checkoutName');
                const phoneInput = document.getElementById('checkoutPhone');
                const addressInput = document.getElementById('checkoutAddress');
                const deliveryTimeSelect = document.getElementById('deliveryTime');
                
                if (!nameInput || !phoneInput || !addressInput || !deliveryTimeSelect) {
                    alert('Form elements not found. Please refresh the page.');
                    return;
                }
                
                const name = nameInput.value.trim();
                const phone = phoneInput.value.trim();
                const address = addressInput.value.trim();
                const deliveryTime = deliveryTimeSelect.value;
                
                if (!name || !phone || !address || !deliveryTime || !selectedPayment) {
                    alert('Please fill in all required fields and select a payment method.');
                    return;
                }
                
                // Validate phone number
                if (!/^\+?[\d\s-]{10,}$/.test(phone)) {
                    alert('Please enter a valid phone number.');
                    return;
                }
                
                // Save user info
                user = { name, phone, address };
                localStorage.setItem('kavency_user', JSON.stringify(user));
                
                // Generate order ID
                const orderId = 'ORD' + Date.now().toString().substr(-6);
                
                // Calculate totals
                const subtotal = cart.reduce((sum, item) => sum + ((item.price || 0) * (item.quantity || 0)), 0);
                const deliveryFee = 15.00;
                const total = subtotal + deliveryFee;
                
                // Create order object
                const order = {
                    id: orderId,
                    customer: name,
                    phone: phone,
                    address: address,
                    date: new Date().toISOString().split('T')[0],
                    deliveryTime: deliveryTime,
                    amount: total,
                    payment: getPaymentMethodName(selectedPayment),
                    status: 'pending',
                    items: cart.map(item => ({
                        name: item.name,
                        price: item.price,
                        quantity: item.quantity
                    }))
                };
                
                // Save order to localStorage
                const orders = JSON.parse(localStorage.getItem('kavency_orders')) || [];
                orders.push(order);
                localStorage.setItem('kavency_orders', JSON.stringify(orders));
                
                // Also save to admin orders
                const adminOrders = JSON.parse(localStorage.getItem('kavency_admin_orders')) || [];
                adminOrders.push(order);
                localStorage.setItem('kavency_admin_orders', JSON.stringify(adminOrders));
                
                // Update the admin panel data
                localStorage.setItem('kavency_store_updated', new Date().toISOString());
                
                // Show success modal
                const orderIdDisplay = document.getElementById('orderIdDisplay');
                const deliveryTimeDisplay = document.getElementById('deliveryTimeDisplay');
                const orderTotalDisplay = document.getElementById('orderTotalDisplay');
                const paymentMethodDisplay = document.getElementById('paymentMethodDisplay');
                
                if (orderIdDisplay) orderIdDisplay.textContent = orderId;
                if (deliveryTimeDisplay) {
                    const selectedOption = deliveryTimeSelect.options[deliveryTimeSelect.selectedIndex];
                    deliveryTimeDisplay.textContent = selectedOption ? selectedOption.text : deliveryTime;
                }
                if (orderTotalDisplay) orderTotalDisplay.textContent = 'K' + total.toFixed(2);
                if (paymentMethodDisplay) paymentMethodDisplay.textContent = getPaymentMethodName(selectedPayment);
                
                closeCheckoutModal();
                const successModal = document.getElementById('successModal');
                if (successModal) successModal.style.display = 'flex';
                
                // Clear cart
                clearCart();
                
                // Show notification
                showNotification('Order placed successfully!', 'success');
            } catch (error) {
                console.error('Error placing order:', error);
                alert('Error placing order. Please try again.');
            }
        }

        function getPaymentMethodName(method) {
            switch(method) {
                case 'mtn': return 'MTN Mobile Money';
                case 'airtel': return 'Airtel Money';
                case 'zamtel': return 'Zamtel Kwacha';
                case 'bank': return 'Bank Transfer';
                default: return 'Unknown';
            }
        }

        function proceedToCheckout() {
            closeCartModal();
            openCheckoutModal();
        }

        function continueShopping() {
            try {
                // Close all modals
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                });
                
                // Show shop section
                showSection('shop');
            } catch (error) {
                console.error('Error continuing shopping:', error);
            }
        }

        // ==================== USER AUTHENTICATION ====================
        function login() {
            try {
                const emailInput = document.getElementById('loginEmail');
                const passwordInput = document.getElementById('loginPassword');
                
                if (!emailInput || !passwordInput) return;
                
                const email = emailInput.value;
                const password = passwordInput.value;
                
                if (!email || !password) {
                    alert('Please enter email and password');
                    return;
                }
                
                // In a real app, this would be an API call
                showNotification('Login successful!', 'success');
                closeLoginModal();
            } catch (error) {
                console.error('Error logging in:', error);
            }
        }

        function register() {
            try {
                const nameInput = document.getElementById('registerName');
                const emailInput = document.getElementById('registerEmail');
                const phoneInput = document.getElementById('registerPhone');
                const passwordInput = document.getElementById('registerPassword');
                
                if (!nameInput || !emailInput || !phoneInput || !passwordInput) return;
                
                const name = nameInput.value;
                const email = emailInput.value;
                const phone = phoneInput.value;
                const password = passwordInput.value;
                
                if (!name || !email || !phone || !password) {
                    alert('Please fill in all fields');
                    return;
                }
                
                // In a real app, this would be an API call
                showNotification('Registration successful!', 'success');
                closeLoginModal();
            } catch (error) {
                console.error('Error registering:', error);
            }
        }

        // ==================== UTILITY FUNCTIONS ====================
        function quickView(productId) {
            try {
                const product = products.find(p => p.id === productId);
                if (product) {
                    alert(`Quick View: ${product.name}\n\nPrice: K${product.price.toFixed(2)}\nDescription: ${product.description}\n\nClick "Add to Cart" to purchase.`);
                }
            } catch (error) {
                console.error('Error in quick view:', error);
            }
        }

        function performSearch() {
            try {
                const searchInput = document.getElementById('searchInput');
                if (!searchInput) return;
                
                const searchTerm = searchInput.value.trim();
                if (searchTerm) {
                    showSection('shop');
                    alert(`Searching for: ${searchTerm}\n\nProducts would be filtered based on your search.`);
                }
            } catch (error) {
                console.error('Error performing search:', error);
            }
        }

        function showNotification(message, type) {
            try {
                // Create notification element
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background-color: ${type === 'success' ? 'var(--success)' : 'var(--danger)'};
                    color: white;
                    padding: 15px 25px;
                    border-radius: 8px;
                    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                    z-index: 3000;
                    animation: slideIn 0.3s ease;
                `;
                notification.textContent = message;
                
                document.body.appendChild(notification);
                
                // Remove notification after 3 seconds
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 3000);
            } catch (error) {
                console.error('Error showing notification:', error);
            }
        }

        function setupEventListeners() {
            try {
                // Close modals when clicking outside
                document.addEventListener('click', function(event) {
                    if (event.target.classList.contains('modal')) {
                        event.target.style.display = 'none';
                    }
                });
                
                // Close modals with Escape key
                document.addEventListener('keydown', function(event) {
                    if (event.key === 'Escape') {
                        document.querySelectorAll('.modal').forEach(modal => {
                            modal.style.display = 'none';
                        });
                    }
                });
                
                // Search on Enter key
                const searchInput = document.getElementById('searchInput');
                if (searchInput) {
                    searchInput.addEventListener('keypress', function(event) {
                        if (event.key === 'Enter') {
                            performSearch();
                        }
                    });
                }
            } catch (error) {
                console.error('Error setting up event listeners:', error);
            }
        }

        // Add CSS for notification animations
        try {
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        } catch (error) {
            console.error('Error adding animation styles:', error);
        }
    </script>
</body>
</html>
